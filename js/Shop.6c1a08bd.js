"use strict";(self["webpackChunkdaojia"]=self["webpackChunkdaojia"]||[]).push([[420],{6041:function(t,c,a){a.d(c,{W:function(){return n}});var e=a(65),o=a(4870),s=a(3396);const n=t=>{const c=(0,e.oR)(),{CartList:a}=(0,o.BK)(c.state),n=(t,a,e)=>{c.commit("addItemToCart",{shopId:t,productid:a,productinfo:e})},r=(t,a,e)=>{0!==c.state.cartList?.[t]?.[a]?.count&&c.commit("downItemToCart",{shopId:t,productid:a,productinfo:e})},_=c.state.cartList,i=(0,s.Fl)((()=>{const c=_[t]?.productList,a=_[t]?.shopName;let e=0,o=0;if(c)for(let t in c){const a=c[t];e+=a.count,a.check&&(o+=a.count*a.price)}const s={};for(let t in c){const a=c[t];a.count>0&&(s[t]=a)}return[e,o.toFixed(2),s,a]}));return{CartList:a,addItemToCart:n,downItemToCart:r,total:i}}},4126:function(t,c,a){a.d(c,{Z:function(){return k}});var e=a(3396),o=a(7139);const s={class:"shop__item"},n=["src"],r={class:"shop__content__title"},_={class:"shop__content__tags"},i={class:"shop__content__tag"},d={class:"shop__content__tag"},l={class:"shop__content__tag"},p={class:"shop__content__highlight"};function u(t,c,a,u,h,m){return(0,e.wg)(),(0,e.iD)("div",s,[(0,e._)("img",{src:`${a.item.imgUrl}`,class:"shop__item__img"},null,8,n),(0,e._)("div",{class:(0,o.C_)(["shop__content",{shop__content:!0,"shop__content--border":!a.hideBorder}])},[(0,e._)("div",r,(0,o.zw)(a.item.name),1),(0,e._)("div",_,[(0,e._)("span",i,"月售:"+(0,o.zw)(a.item.sales),1),(0,e._)("span",d,"起送:￥"+(0,o.zw)(a.item.expressLimit),1),(0,e._)("span",l,"基础运费:￥"+(0,o.zw)(a.item.expressPrice),1)]),(0,e._)("p",p,(0,o.zw)(a.item.slogan),1)],2)])}var h={name:"Shopinfo",props:["item","hideBorder"],setup(){}},m=a(89);const C=(0,m.Z)(h,[["render",u],["__scopeId","data-v-580117c3"]]);var k=C},1157:function(t,c,a){a.r(c),a.d(c,{default:function(){return ft}});var e=a(3396),o=a(9242);const s=t=>((0,e.dD)("data-v-5df29ea6"),t=t(),(0,e.Cn)(),t),n={class:"wrapper"},r={class:"search"},_=s((()=>(0,e._)("div",{class:"search__content"},[(0,e._)("span",{class:"search__content__icon iconfont"},""),(0,e._)("input",{class:"search__content__input",placeholder:"请输入商品名称"})],-1)));function i(t,c,a,s,i,d){const l=(0,e.up)("Shopinfo"),p=(0,e.up)("content"),u=(0,e.up)("cart");return(0,e.wg)(),(0,e.iD)("div",n,[(0,e._)("div",r,[(0,e._)("div",{class:"search__back iconfont",onClick:c[0]||(c[0]=(...t)=>s.handleBackClick&&s.handleBackClick(...t))},""),_]),(0,e.wy)((0,e.Wm)(l,{item:s.data.item,hideBorder:!0},null,8,["item"]),[[o.F8,s.data.item.imgUrl]]),(0,e.Wm)(p,{shopName:s.data.item.name},null,8,["shopName"]),(0,e.Wm)(u)])}var d=a(4870),l=a(4126),p=a(678),u=a(4471),h=a(7139);const m=t=>((0,e.dD)("data-v-3abd62fe"),t=t(),(0,e.Cn)(),t),C={class:"content"},k={class:"category"},w=["onClick"],v={class:"product"},g=["src"],I={class:"product__item__detail"},f={class:"product__item__title"},b={class:"product__item__sales"},L={class:"product__item__price"},T=m((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),y={class:"product__item__origin"},z={class:"product__number"},D=["onClick"],P=["onClick"];function U(t,c,a,o,s,n){return(0,e.wg)(),(0,e.iD)("div",C,[(0,e._)("div",k,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(o.cateList,(t=>((0,e.wg)(),(0,e.iD)("div",{class:(0,h.C_)({category__item:!0,"category__item--active":o.currentTab===t.tab}),key:t.tab,onClick:c=>o.handleCateClick(t.tab)},(0,h.zw)(t.name),11,w)))),128))]),(0,e._)("div",v,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(o.contentList,((c,s)=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:s},[(0,e._)("img",{class:"product__item__img",src:c.imgUrl},null,8,g),(0,e._)("div",I,[(0,e._)("h4",f,(0,h.zw)(c.name),1),(0,e._)("p",b,"月售"+(0,h.zw)(c.sales)+"件",1),(0,e._)("p",L,[T,(0,e.Uk)((0,h.zw)(c.price)+" ",1),(0,e._)("span",y,"¥"+(0,h.zw)(c.oldPrice),1)])]),(0,e._)("div",z,[(0,e._)("span",{class:"product__number__minus",onClick:t=>o.downItemToCart(o.shopId,c._id,c)},"-",8,D),(0,e.Uk)(" "+(0,h.zw)(t.$store.state.cartList?.[o.shopId]?.productList?.[c._id]?.count||0)+" ",1),(0,e._)("span",{class:"product__number__plus",onClick:t=>o.changeShopName(o.shopId,c._id,c,a.shopName)},"+",8,P)])])))),128))])])}var N=a(65),B=a(6041);const H=()=>{const t=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"}],c=(0,p.yj)(),a=(0,d.qj)({contentList:[],currentTab:"all"}),e=async t=>{const e=await(0,u.U)(`/api/shop/${c.params.id}/products?tab=${t}`);0===e.errno&&e.data.length&&(a.contentList=e.data)};e("all");const o=t=>{a.currentTab=t,e(t)},s=(0,N.oR)(),n=(t,c)=>{s.commit("changeShopName",{shopId:t,shopName:c})},{contentList:r,currentTab:_}=(0,d.BK)(a);return{contentList:r,cateList:t,handleCateClick:o,currentTab:_,changeShopidName:n}};var S={name:"Content",props:["shopName"],setup(){const t=(0,p.yj)(),c=t.params.id,{contentList:a,cateList:e,handleCateClick:o,currentTab:s,changeShopidName:n}=H(),{CartList:r,addItemToCart:_,downItemToCart:i}=(0,B.W)(),d=(t,c,a,e)=>{_(t,c,a),n(t,e)};return{contentList:a,cateList:e,handleCateClick:o,currentTab:s,CartList:r,shopId:c,addItemToCart:_,downItemToCart:i,changeShopName:d}}},j=a(89);const W=(0,j.Z)(S,[["render",U],["__scopeId","data-v-3abd62fe"]]);var F=W;const Z=t=>((0,e.dD)("data-v-180f91b0"),t=t(),(0,e.Cn)(),t),$={class:"cart"},q={key:0,class:"product"},A={class:"product__header"},K={class:"product__header__all"},Y=["innerHTML"],M=(0,e.Uk)(" 全选"),x={class:"product__header__clear"},R={key:0,class:"product__item"},O=["innerHTML","onClick"],E=["src"],G={class:"product__item__detail"},J={class:"product__item__title"},Q=Z((()=>(0,e._)("p",{class:"product__item__sales"},null,-1))),V={class:"product__item__price"},X=Z((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),tt={class:"product__item__origin"},ct={class:"product__number"},at=["onClick"],et=["onClick"],ot={class:"check"},st={class:"check__icon"},nt={class:"check__icon__tag"},rt={class:"check__info"},_t=(0,e.Uk)(" 总计："),it={class:"check__info__price"},dt={class:"check__btn"},lt=(0,e.Uk)(" 去结算 "),pt={class:"check__btn check__btn__gray"};function ut(t,c,a,s,n,r){const _=(0,e.up)("router-link");return(0,e.wg)(),(0,e.iD)(e.HY,null,[s.showCart?((0,e.wg)(),(0,e.iD)("div",{key:0,class:"mask",onClick:c[0]||(c[0]=(...t)=>s.showProduct&&s.showProduct(...t))})):(0,e.kq)("",!0),(0,e._)("div",$,[s.showCart?((0,e.wg)(),(0,e.iD)("div",q,[(0,e._)("div",A,[(0,e._)("div",K,[(0,e._)("span",{class:(0,h.C_)({product__header__check:!0,iconfont:!0,isorcheck:s.allCheck}),innerHTML:s.allCheck?"":"",onClick:c[1]||(c[1]=t=>s.productCheckAll(s.shopId))},null,10,Y),M]),(0,e._)("div",x,[(0,e._)("span",{onClick:c[2]||(c[2]=t=>s.cleanCartProducts(s.shopId))},"清空购物车")])]),((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(s.total[2],((t,c)=>((0,e.wg)(),(0,e.iD)(e.HY,{key:c},[t.count>0?((0,e.wg)(),(0,e.iD)("div",R,[(0,e._)("div",{innerHTML:t.check?"":"",class:(0,h.C_)({product__item__checked:!0,iconfont:!0,isorcheck:t.check}),onClick:c=>s.changeCartItemChecked(s.shopId,t._id)},null,10,O),(0,e._)("img",{class:"product__item__img",src:t.imgUrl},null,8,E),(0,e._)("div",G,[(0,e._)("h4",J,(0,h.zw)(t.name),1),Q,(0,e._)("p",V,[X,(0,e.Uk)((0,h.zw)(t.price)+" ",1),(0,e._)("span",tt,"¥"+(0,h.zw)(t.oldPrice),1)])]),(0,e._)("div",ct,[(0,e._)("span",{class:"product__number__minus",onClick:c=>s.downItemToCart(s.shopId,t._id,t)},"-",8,at),(0,e.Uk)(" "+(0,h.zw)(t.count||0)+" ",1),(0,e._)("span",{class:"product__number__plus",onClick:c=>s.addItemToCart(s.shopId,t._id,t)},"+",8,et)])])):(0,e.kq)("",!0)],64)))),128))])):(0,e.kq)("",!0),(0,e._)("div",ot,[(0,e._)("div",st,[(0,e._)("span",{class:"iconfont check__icon__img",onClick:c[3]||(c[3]=(...t)=>s.showProduct&&s.showProduct(...t))},""),(0,e._)("div",nt,(0,h.zw)(s.total[0]),1)]),(0,e._)("div",rt,[_t,(0,e._)("span",it,"¥ "+(0,h.zw)(s.total[1]),1)]),(0,e.wy)((0,e._)("div",dt,[(0,e.Wm)(_,{to:{path:`/OrderConfirmation/${s.shopId}`}},{default:(0,e.w5)((()=>[lt])),_:1},8,["to"])],512),[[o.F8,s.total[0]>0]]),(0,e.wy)((0,e._)("div",pt," 去结算 ",512),[[o.F8,s.total[0]<=0]])])])],64)}const ht=()=>{const t=(0,N.oR)(),c=(0,p.yj)(),a=c.params.id,o=t.state.cartList,s=(c,a)=>{t.commit("changeCartItemChecked",{shopId:c,productId:a})},n=c=>{t.commit("cleanCartProducts",{shopId:c})},r=c=>{t.commit("productCheckAll",{shopId:c})},_=(0,e.Fl)((()=>{const t=o[a]?.productList;let c=!0;if(t)for(let a in t){const e=t[a];e.count>0&&!e.check&&(c=!1)}return c}));return{shopId:a,changeCartItemChecked:s,cleanCartProducts:n,productCheckAll:r,allCheck:_}},mt=()=>{let t=(0,d.iH)(!1);const c=()=>{t.value=!t.value};return{showCart:t,showProduct:c}};var Ct={name:"Cart",setup(){const{showCart:t,showProduct:c}=mt(),{shopId:a,changeCartItemChecked:e,cleanCartProducts:o,productCheckAll:s,allCheck:n}=ht(),{CartList:r,addItemToCart:_,downItemToCart:i,total:d}=(0,B.W)(a);return{total:d,addItemToCart:_,downItemToCart:i,shopId:a,changeCartItemChecked:e,cleanCartProducts:o,productCheckAll:s,allCheck:n,showProduct:c,showCart:t}}};const kt=(0,j.Z)(Ct,[["render",ut],["__scopeId","data-v-180f91b0"]]);var wt=kt;const vt=()=>{const t=(0,p.tv)(),c=(0,p.yj)(),a=(0,d.qj)({item:{}}),e=async()=>{const t=await(0,u.U)(`/api/shop/${c.params.id}`);0===t.errno&&t.data&&(a.item=t.data)};e();const o=()=>{t.back()};return{data:a,handleBackClick:o}};var gt={name:"Shop",components:{Shopinfo:l.Z,Content:F,Cart:wt,Cart:wt},setup(){const{data:t,handleBackClick:c}=vt();return{data:t,handleBackClick:c}}};const It=(0,j.Z)(gt,[["render",i],["__scopeId","data-v-5df29ea6"]]);var ft=It}}]);
//# sourceMappingURL=Shop.6c1a08bd.js.map