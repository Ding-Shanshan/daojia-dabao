"use strict";(self["webpackChunkdaojia"]=self["webpackChunkdaojia"]||[]).push([[791],{6041:function(t,s,a){a.d(s,{W:function(){return c}});var r=a(65),o=a(4870),e=a(3396);const c=t=>{const s=(0,r.oR)(),{CartList:a}=(0,o.BK)(s.state),c=(t,a,r)=>{s.commit("addItemToCart",{shopId:t,productid:a,productinfo:r})},n=(t,a,r)=>{0!==s.state.cartList?.[t]?.[a]?.count&&s.commit("downItemToCart",{shopId:t,productid:a,productinfo:r})},i=s.state.cartList,d=(0,e.Fl)((()=>{const s=i[t]?.productList,a=i[t]?.shopName;let r=0,o=0;if(s)for(let t in s){const a=s[t];r+=a.count,a.check&&(o+=a.count*a.price)}const e={};for(let t in s){const a=s[t];a.count>0&&(e[t]=a)}return[r,o.toFixed(2),e,a]}));return{CartList:a,addItemToCart:c,downItemToCart:n,total:d}}},8573:function(t,s,a){a.r(s),a.d(s,{default:function(){return at}});var r=a(3396);const o={class:"wrapper"};function e(t,s,a,e,c,n){const i=(0,r.up)("Top-area"),d=(0,r.up)("Product-list"),_=(0,r.up)("Order");return(0,r.wg)(),(0,r.iD)("div",o,[(0,r.Wm)(i),(0,r.Wm)(d),(0,r.Wm)(_)])}var c=a(65),n=a(678);const i={class:"top"},d={class:"top__header"},_=(0,r.Uk)(" 确认订单 "),p=(0,r.uE)('<div class="top__receiver" data-v-5fb9f1a3><div class="top__receiver__title" data-v-5fb9f1a3>收货地址</div><div class="top__receiver__address" data-v-5fb9f1a3>北京理工大学国防科技园2号楼10层</div><div class="top__receiver__info" data-v-5fb9f1a3><span class="top__receiver__info__name" data-v-5fb9f1a3>瑶妹（先生）</span><span class="top__receiver__info__name" data-v-5fb9f1a3>18911024266</span></div><div class="iconfont top__receiver__icon" data-v-5fb9f1a3></div></div>',1);function l(t,s,a,o,e,c){return(0,r.wg)(),(0,r.iD)("div",i,[(0,r._)("div",d,[(0,r._)("div",{class:"iconfont top__header__back",onClick:s[0]||(s[0]=(...t)=>o.handleBackClick&&o.handleBackClick(...t))},""),_]),p])}const u=()=>{const t=(0,n.tv)(),s=()=>{t.back()};return{handleBackClick:s}};var m={name:"TopArea",setup(){const{handleBackClick:t}=u();return{handleBackClick:t}}},v=a(89);const f=(0,v.Z)(m,[["render",l],["__scopeId","data-v-5fb9f1a3"]]);var h=f,k=a(7139);const C=t=>((0,r.dD)("data-v-826ae776"),t=t(),(0,r.Cn)(),t),w={class:"products"},b={class:"products__title"},I={class:"products__wrapper"},L={class:"products__list"},O={key:0,class:"products__item"},N=["src"],g={class:"products__item__detail"},y={class:"products__item__title"},D={class:"products__item__price"},T=C((()=>(0,r._)("span",{class:"products__item__yen"},"¥ ",-1))),z={class:"products__item__total"},B=C((()=>(0,r._)("span",{class:"products__item__yen"},"¥ ",-1)));function j(t,s,a,o,e,c){return(0,r.wg)(),(0,r.iD)("div",w,[(0,r._)("div",b,(0,k.zw)(o.shopName),1),(0,r._)("div",I,[(0,r._)("div",L,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.productList,(t=>((0,r.wg)(),(0,r.iD)(r.HY,{key:t._id},[t.count>0?((0,r.wg)(),(0,r.iD)("div",O,[(0,r._)("img",{class:"products__item__img",src:t.imgUrl},null,8,N),(0,r._)("div",g,[(0,r._)("h4",y,(0,k.zw)(t.name),1),(0,r._)("p",D,[(0,r._)("span",null,[T,(0,r.Uk)(" "+(0,k.zw)(t.price)+" x "+(0,k.zw)(t.count),1)]),(0,r._)("span",z,[B,(0,r.Uk)(" "+(0,k.zw)((t.price*t.count).toFixed(2)),1)])])])])):(0,r.kq)("",!0)],64)))),128))])])])}const U=()=>{const t=(0,c.oR)(),s=(0,n.yj)(),a=s.params.id,r=t.state.cartList[a].shopName,o=t.state.cartList[a].productList;return{shopName:r,shopId:a,productList:o}};var W={name:"ProductList",setup(){const{shopName:t,shopId:s,productList:a}=U();return{shopName:t,shopId:s,productList:a}}};const F=(0,v.Z)(W,[["render",j],["__scopeId","data-v-826ae776"]]);var H=F,P=a(9242);const R=t=>((0,r.dD)("data-v-216e3a9e"),t=t(),(0,r.Cn)(),t),Z={class:"order"},x={class:"order__price"},Y=(0,r.Uk)("实付金额 "),A=R((()=>(0,r._)("h3",{class:"mask__content__title"},"确认要离开收银台？",-1))),K=R((()=>(0,r._)("p",{class:"mask__content__desc"},"请尽快完成支付，否则将被取消",-1))),q={class:"mask__content__btns"};function E(t,s,a,o,e,c){return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",Z,[(0,r._)("div",x,[Y,(0,r._)("b",null,"¥"+(0,k.zw)(o.total[1]),1)]),(0,r._)("div",{class:"order__btn",onClick:s[0]||(s[0]=t=>o.submitOrder(!0))},"提交订单")]),(0,r.wy)((0,r._)("div",{class:"mask",onClick:s[4]||(s[4]=t=>o.submitOrder(!1))},[(0,r._)("div",{class:"mask__content",onClick:s[3]||(s[3]=(0,P.iM)((()=>{}),["stop"]))},[A,K,(0,r._)("div",q,[(0,r._)("div",{class:"mask__content__btn mask__content__btn--first",onClick:s[1]||(s[1]=t=>o.handleConfirmOrder(o.total,!0))},"取消订单"),(0,r._)("div",{class:"mask__content__btn mask__content__btn--last",onClick:s[2]||(s[2]=t=>o.handleConfirmOrder(o.total,!1))},"确认支付")])])],512),[[P.F8,o.isshow]])],64)}var M=a(4471),G=a(6041),J=a(4870);const Q=(t,s)=>{const a=(0,n.tv)(),r=(0,c.oR)(),o=(0,J.iH)(!1),e=t=>{o.value=t},i=async o=>{const e=s[2],c=[];for(let t in e){const s=e[t];c.push({id:parseInt(s._id),num:s.count})}try{const e=await(0,M.v)("/api/order",{addressId:1,shopId:parseInt(t),shopName:s[3],isCanceled:o,products:c});0===e?.errno&&(r.commit("cleanCartProducts",{shopId:t}),a.push({name:"OrderList"}))}catch(n){}};return{handleConfirmOrder:i,submitOrder:e,isshow:o}};var S={name:"Order",setup(){const t=(0,n.yj)(),s=parseInt(t.params.id,10),{total:a}=(0,G.W)(s),{handleConfirmOrder:r,submitOrder:o,isshow:e}=Q(s,a);return{handleConfirmOrder:r,total:a,isshow:e,submitOrder:o}}};const V=(0,v.Z)(S,[["render",E],["__scopeId","data-v-216e3a9e"]]);var X=V;const $=()=>{const t=(0,c.oR)(),s=(0,n.yj)(),a=s.params.id,r=t.state.cartList[a].shopName,o=t.state.cartList[a].productList;return{shopName:r,shopId:a,productList:o}};var tt={components:{TopArea:h,ProductList:H,Order:X},name:"OrderConfirmation",setup(){const{shopName:t,shopId:s,productList:a}=$();return{shopName:t,shopId:s,productList:a}}};const st=(0,v.Z)(tt,[["render",e],["__scopeId","data-v-54dcf44e"]]);var at=st}}]);
//# sourceMappingURL=OrderConfirmation.e9d230e0.js.map